<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>PrescriÃ§Ã£o Memed</title>
</head>

<body>

  <h2>PrescriÃ§Ã£o Memed</h2>

  <script>
    function initMemed() {
      const script = document.createElement("script");

      script.src =
        "https://integrations.memed.com.br/modulos/plataforma.sinapse-prescricao/build/sinapse-prescricao.min.js";

      // ðŸ” TOKEN AQUI (homologaÃ§Ã£o ou produÃ§Ã£o)
      script.dataset.token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.WzkwMzg3LCIwYTZiZTgwM2U1YTcwNTg5NDJmZGQ2NmU3MzU2YWM1MSIsIjIwMjYtMDEtMjIiLCJzaW5hcHNlLnByZXNjcmljYW8iLCJwYXJ0bmVyLjMuODU1MjAiXQ.DbTqxosooGFCD6OhWW_ClktXPZN4B1Ecnev4OsavoXs";

      script.addEventListener("load", () => {
        console.log("ðŸ“¦ Script Memed carregado");

        MdSinapsePrescricao.event.add(
          "core:moduleInit",
          async function (module) {
            console.log("ðŸ”” MÃ³dulo iniciado:", module.name);

            if (module.name === "plataforma.prescricao") {
              console.log("âœ… PrescriÃ§Ã£o pronta");

              await MdHub.command.send(
                "plataforma.prescricao",
                "setPaciente",
                {
                  idExterno: "ninsaude-123",
                  nome: "Maria da Silva",
                  telefone: "11999999999",
                  cpf: "12345678900",
                  endereco: "Rua das Flores, 123"
                }
              );

              MdHub.module.show("plataforma.prescricao");
            }
          }
        );
      });

      document.body.appendChild(script);
    }

    initMemed();
  </script>

</body>
</html>
